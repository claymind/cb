<section class="droppable"></section>
<section ng-class="{'iscollapsed': listItem.isCollapsed}">
    <div class="grip-bar clearfix" title="Drag and drop to change order">
        <div class="handle">
            <label>{{listItem.order}}.</label>
        </div>
        <div class="list-item-header clearfix">
            <div class="header-desc"><span class="item-type">{{listItem.type}}</span>&nbsp;:&nbsp;<span class="item-name">{{listItem.name || listItem.title}}</span></div>
            <div class="action">
                <span class="toggle-collapse glyphicon {{!listItem.isCollapsed ? 'glyphicon-chevron-up' : 'glyphicon-chevron-down'}}" title="{{!listItem.isCollapsed ? 'Collapse View' : 'Expand View'}}"  ></span>
            </div>
        </div>
    </div>
    <ul id="{{listItem.$$hashKey}}" collapse="listItem.isCollapsed">
        <li class="form-group">
            <label class="col-sm-2 control-label">Order</label>
            <div class="col-sm-8">
                <input type="number" name="order" min="1" class="form-control item-order" ng-model="listItem.order"  integer  />
            </div>
        </li>

        <li class="form-group">
            <label class="col-sm-2 control-label">Type</label>
            <div class="col-sm-8">
                <select ng-model="listItem.type" class="form-control" ng-change="onTypeChange($viewValue)"  ng-options="obj.id as obj.title for obj in settings.listItemTypes">
                    <option class="form-control" value="item">Choose Type</option>
                </select>
            </div>
        </li>
        <li class="form-group" ng-hide="listItem.type === 'item'">
            <label class="col-sm-2 control-label">{{getTypeLabel(listItem.type)}} Name</label>
            <div class="col-sm-8">
                <input type="text" maxlength="250" name="itemName" typeahead-min-length="minlength" ng-model="listItem.name" typeahead-wait-ms="typeaheadWaitMs" typeahead-on-select="$parent.onDocSelect($item, $model, $label, 'name')"  placeholder="Choose Document" typeahead="item.name for item in $parent.getDocuments($viewValue, listItem.type, 'name') | filter:$viewValue" typeahead-loading="loadingDocs" class="form-control item-name" ng-readonly="listItem.type === 'item'" />
                <i ng-show="loadingDocs" class="glyphicon glyphicon-refresh"></i>
            </div>
        </li>
        <li class="form-group" ng-hide="listItem.type === 'item'">
            <label class="col-sm-2 control-label">{{getTypeLabel(listItem.type)}} ID</label>
            <div class="col-sm-8">
                <input type="text" maxlength="250" placeholder="{{listItem.id}}" ng-model="listItem.id" class="form-control item-id" ng-readonly="true" />
            </div>
        </li>
        <li class="form-group has-view">
            <label class="col-sm-2 control-label">Image Uri</label>
            <div class="col-sm-8">
                <small class="image-url preview">View</small>
                <input type="text" maxlength="250" placeholder="{{listItem.origImage.uri}}" ng-model="listItem.image.uri" class="form-control item-image-url"  />
            </div>
            <div class="image-url-thumbnail col-sm-2" title="Click for full size image"><img ng-src="{{getThumbnail(listItem.image.uri)}}" class="thumbnail" /></div>
        </li>
        <li class="form-group">
            <label  class="col-sm-2 control-label">Image Alt</label>
            <div class="col-sm-8">
                <input type="text"  maxlength="250" placeholder="{{listItem.origImage.alt}}" ng-model="listItem.image.alt" class="form-control item-image-alt"  />
            </div>
        </li>
        <li class="form-group">
            <label class="col-sm-2 control-label">Title</label>
            <div class="col-sm-8">
                <input type="text" maxlength="250" placeholder="{{listItem.origTitle}}" ng-model="listItem.title" class="form-control item-title"  />
            </div>
        </li>
        <li class="form-group">
            <label class="col-sm-2 control-label">Subtitle</label>
            <div class="col-sm-8">
                <input type="text" maxlength="250" placeholder="{{listItem.origSubTitle}}" ng-model="listItem.subTitle" class="form-control item-subtitle"  />
            </div>
        </li>
        <li class="form-group has-view">
            <label class="col-sm-2 control-label">Url</label>
            <div class="col-sm-8">
                <small class="item-url preview">View</small>
                <input type="text" maxlength="250" type="url" class="form-control item-url" ng-model="listItem.url" />
            </div>
        </li>
        <li class="form-group has-view">
            <label class="col-sm-2 control-label">Author</label>
            <div class="col-sm-8">
                <small class="author preview">View</small>
                <input type="text" name="itemAuthor" typeahead-min-length="minlength" ng-model="listItem.author" typeahead-wait-ms="typeaheadWaitMs" typeahead-on-select="$parent.onDocSelect($item, $model, $label, 'author')"  placeholder="Choose Author" typeahead="item.name for item in $parent.getDocuments($viewValue, 'author', 'author') |  filter:$viewValue" typeahead-loading="loadingAuthors" class="form-control item-author" ng-readonly="listItem.type !== 'item'" />
                <i ng-show="loadingAuthors" class="glyphicon glyphicon-refresh"></i>
            </div>
        </li>
        <li class="form-group remove-item clearfix">
            <button type="button" class="btn btn-danger btn-sm remove" title="Remove item from list" ng-click="$parent.deleteListItem($parent.$index)"><span class="remove glyphicon glyphicon-remove-circle"></span>Remove</button>
        </li>
    </ul>
</section>
<section class="droppable" ng-show="$parent.$last"></section>